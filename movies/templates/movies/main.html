{% extends 'base.html' %}
{% load bootstrap4 %}
{% load static %}

{% block title %}MOVIE EIVOM{% endblock title %}

{% block style %}
  .carousel-video-inner {
    text-align: center;
  }
  .swiper-container {
    width: 100%;
    height: 100%;
  }
  .swiper-slide {
    text-align: center;
    font-size: 18px;
    background: #fff;
    /* Center slide text vertically */
    display: -webkit-box;
    display: -ms-flexbox;
    display: -webkit-flex;
    display: flex;
    -webkit-box-pack: center;
    -ms-flex-pack: center;
    -webkit-justify-content: center;
    justify-content: center;
    -webkit-box-align: center;
    -ms-flex-align: center;
    -webkit-align-items: center;
    align-items: center;
  }
  #recommend .swiper-container {
    width: 100%;
    padding-top: 50px;
    padding-bottom: 50px;
  }

  #recommend .swiper-slide {
      background-position: center;
        background-size: cover;
        width: 300px;
        height: 420px;
  }
{% endblock style %}

{% block content %}
<!-- NOW PLAYING -->
<!-- backdrop 사용, 별도 버튼 클릭 시 예매 사이트로 이동할 것임 -->
<!-- backdrop 에는 링크가 들어갈 일이 없음 -->
<div class="alert alert-light" role="alert">
  
</div>
<div class="swiper-container">
  <div class="swiper-wrapper">
    {% for nowplay in nowplays %}
    {% if nowplay.image %}
    <!-- <div class="swiper-slide js-imgSizeSame"
      style="background:url('{{ nowplay.image }}') no-repeat; width: 500px; height: 300px; background-size: 500px 300px;"> -->
    <div class="swiper-slide">
      <div class="main-img">
        <img src="{{ nowplay.image }}" alt="{{ nowplay.title }}" style="max-width: 100%; height: auto;">
      </div>
      <div class="content" style="position: absolute; top: 70%; center;">
        <h2 class="text-light mb-3">{{ nowplay.title }}</h2>
        <a href="https://ticket2.movie.daum.net/Movie/MovieMain.aspx?M_ID={{ nowplay.code }}#seq=2"
          class="btn btn-outline-light">예매하기</a>
      </div>
    </div>
    {% endif %}
    {% endfor %}
  </div>
  <!-- Add Arrows -->
  <div class="swiper-button-next" style="color: white;"></div>
  <div class="swiper-button-prev" style="color: white;"></div>
</div>


<!-- 추천 부분 SWIPER -->
<!-- backdrop 아니고 poster 사용; 클릭하면 detail 페이지로 넘어갈 것임-->
<hr>
  <div class="text-center text-white mg-0">
    <h1 class="text-dark">당신을 위한 추천 영화</h1>
    <div id="recommend" class="swiper-container s2">
        <div class="swiper-wrapper">
            {% for recommend in recommends %}
            <div id="recommend" class="swiper-slide s2" style="background: linear-gradient(to top, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0) 50%, rgba(0, 0, 0, 0.5) 100%),
                                url('{{ recommend.poster_path }}') no-repeat; 
                                background-size: 100% 100%;"
                onclick="location.href='{% url 'movies:detail' recommend.pk %}'">
                <h2>{{ recommend.title }}</h2>
            </div>
            {% endfor %}
        </div>
    </div>
  </div>



<!-- Youtube SWIPER; navigation -->
<!-- https://awesomelon.github.io/dev/swiperjs-in-youtube/ 참조 -->
<hr>
<!-- Swiper -->
<!-- Carousel -->
<h1 class="text-center mt-5 mb-5">EIVOM 추천 영화</h1>
<div id="myCarousel" class="carousel slide w-75 mx-auto" data-ride="carousel">
    <div class="carousel-inner" role="listbox">
        <!-- 02_carousel -->
        <div class="carousel-item active">
          <div class="embed-responsive embed-responsive-16by9">
              <iframe id="player" src="https://www.youtube.com/embed/{{ show1.code }}?rel=0&amp;enablejsapi=1&version=3&playerapiid=ytplayer" allowfullscreen></iframe>
          </div><!-- end .embed-responsive -->
        </div><!-- end .02_carousel -->
        <!-- 02_carousel -->
        <!-- 02_carousel -->
        <div class="carousel-item">
          <div class="embed-responsive embed-responsive-16by9">
              <iframe id="player" src="https://www.youtube.com/embed/{{ show2.code }}?rel=0&amp;enablejsapi=1&version=3&playerapiid=ytplayer" allowfullscreen></iframe>
          </div><!-- end .embed-responsive -->
        </div><!-- end .02_carousel -->
        <!-- 02_carousel -->
        <!-- 02_carousel -->
        <div class="carousel-item">
          <div class="embed-responsive embed-responsive-16by9">
              <iframe id="player" src="https://www.youtube.com/embed/{{ show3.code }}?rel=0&amp;enablejsapi=1&version=3&playerapiid=ytplayer" allowfullscreen></iframe>
          </div><!-- end .embed-responsive -->
        </div><!-- end .02_carousel -->
        <!-- 02_carousel -->
        <!-- 02_carousel -->
        <div class="carousel-item">
          <div class="embed-responsive embed-responsive-16by9">
              <iframe id="player" src="https://www.youtube.com/embed/{{ show4.code }}?rel=0&amp;enablejsapi=1&version=3&playerapiid=ytplayer" allowfullscreen></iframe>
          </div><!-- end .embed-responsive -->
        </div><!-- end .02_carousel -->
        <!-- 02_carousel -->

    </div><!-- end .carousel-inner -->
    <!-- Controls -->
    <a class="carousel-control-prev" href="#myCarousel" role="button" data-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="sr-only">Previous</span>
    </a>
    <a class="carousel-control-next" href="#myCarousel" role="button" data-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="sr-only">Next</span>
    </a><!-- end .Control -->
</div><!-- end .myCarousel -->



<script>
  var player;
  function onYouTubeIframeAPIReady() {
      player = new YT.Player('player', {
          events: {
              'onStateChange': onPlayerStateChange
          }
      });
  }

  function onPlayerReady(event) {
      event.target.playVideo();
  }

  var done = false;
  function onPlayerStateChange(event) {
      if (event.data == YT.PlayerState.PLAYING && !done) {
          $('#myCarousel').carousel('pause');
          done = true;
      }
  }

</script>
{% endblock %}